<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<style> body { background: #EADDCA; } </style>


<body>
    submitted issues <br> <br>

    <!-- simpler to concate all user issues to 1 instead? (need state the owner too, so not good.) -->

<% all_user_issues.forEach( user => { %>
<% if (user.usertype == 'admin') {return} //forEach cant use continue, use return OR .filter to remove  %>
    

        <%= user.name %>
        <table border>
            <tr>
                <th>issue_title</th>
                <th>description</th>
                <th>urgency</th>
                <th>comment</th>
                <th>edit</th>
                <th>createdAt / editedOn </th>
            </tr>

        <!-- foreach here that loop through returned list -->
        <% user.issue.forEach( issue => { %>
        <% let createdAt = issue.createdAt.toString() %>  
        <% createdAt = createdAt.split(" ").slice(0,5).join(" ") %>  
        <!-- TypeError, cant use string method on date object!!! -->
        <!-- convert Date to string first by .toString() omg...  -->


        <tr>
            <td> <%= issue.issue_title %> </td>
            <td> <%= issue.description %> </td>
            <td> <%= issue.urgency %> </td>
            <td> <%= issue.comment %> </td>

            <td> 
                <form method="post" action="/admin/comment" >      
                    <button type='submit'value="<%=issue.createdAt%>,<%=user.name%>" name="comment">Comment</button>  <!--sub issue._id with createdAt--> 
                </form>
            </td>

            <td> <%= createdAt %> </td>
        </tr>
    <% }) %> 
</table> <br>

<% }) %>


    <a href="/admin">Return</a>


</body>
</html>